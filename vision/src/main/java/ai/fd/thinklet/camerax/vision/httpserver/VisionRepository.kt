package ai.fd.thinklet.camerax.vision.httpserver

/**
 * HTTPサーバーを介して画像やカメラ制御機能を提供するためのリポジトリインターフェース。
 * サーバーの起動、停止、および配信するJPEG画像の更新といった操作を定義する。
 */
interface VisionRepository {

    /**
     * 指定されたポート番号でHTTPサーバーを起動する。
     * サーバーが正常に起動すると、外部からのHTTPリクエストを受け付けられる状態になる。
     * 既にサーバーが起動している場合に再度呼び出された場合の動作は実装に依存するが、
     * 一般的には無視されるか、エラーログが出力される。
     *
     * @param port HTTPサーバーがリッスンするポート番号。
     */
    fun start(port: Int)

    /**
     * 現在実行中のHTTPサーバーを停止する。
     * サーバーが停止すると、新たなHTTPリクエストの受付を中止し、関連リソースを解放する。
     * サーバーが起動していない場合に呼び出された場合の動作は実装に依存するが、
     * 一般的には無視されるか、エラーログが出力される。
     */
    fun stop()

    /**
     * HTTPサーバーが配信する最新のJPEG画像を更新する。
     * このメソッドで提供されたバイト配列の画像データが、例えば `/image` エンドポイントなどから
     * クライアントに配信されることを想定している。
     * サーバーが起動していない状態で呼び出された場合、画像データはキャッシュされるか破棄されるかは実装に依存する。
     *
     * @param bytes 更新するJPEG画像のバイト配列。
     */
    fun updateJpeg(bytes: ByteArray)
}
